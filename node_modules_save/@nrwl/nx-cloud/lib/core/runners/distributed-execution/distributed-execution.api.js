const a7_0x3126=['NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','parallel','dteStart','message','value','hash','__esModule','stringify','stopAgentsOnFailure','throw','post','maxParallel','defineProperty','exit','note','map','true','done','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','../../../utilities/serializer-overrides','RUNNER_FAILURE_PERF_ENTRY','/nx-cloud/executions/status','../../../utilities/metric-logger','data','apiAxiosInstance','../../../utilities/environment','project','createMetricRecorder','Starting\x20a\x20distributed\x20execution','completeRunGroupWithError','recordMetric','/nx-cloud/executions/start','false','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','start','mapRespToPerfEntry','__awaiter','/nx-cloud/executions/complete-run-group','then','VERBOSE_LOGGING','DistributedExecutionApi','../../../utilities/nx-imports','axiosMultipleTries','target','runGroup:\x20','completeRunGroup','createStartRequest','error','axiosException','Completing\x20run\x20group\x20with\x20an\x20error','status','configuration','../../../utilities/axios','response','createApiAxiosInstance','serializeOverrides','getBranch'];(function(_0x63353,_0x312655){const _0x322c30=function(_0x891e48){while(--_0x891e48){_0x63353['push'](_0x63353['shift']());}};_0x322c30(++_0x312655);}(a7_0x3126,0x65));const a7_0x322c=function(_0x63353,_0x312655){_0x63353=_0x63353-0x0;let _0x322c30=a7_0x3126[_0x63353];return _0x322c30;};'use strict';var __awaiter=this&&this[a7_0x322c('0x31')]||function(_0x249080,_0x352389,_0x10c7e3,_0x4a56e2){function _0xf13239(_0x1cf6cb){return _0x1cf6cb instanceof _0x10c7e3?_0x1cf6cb:new _0x10c7e3(function(_0x4b9ceb){_0x4b9ceb(_0x1cf6cb);});}return new(_0x10c7e3||(_0x10c7e3=Promise))(function(_0x17c9e8,_0x1b5040){function _0x68e226(_0x10813e){try{_0x3cfd2c(_0x4a56e2['next'](_0x10813e));}catch(_0x1c6cca){_0x1b5040(_0x1c6cca);}}function _0x66d7b4(_0x30ac0f){try{_0x3cfd2c(_0x4a56e2[a7_0x322c('0x16')](_0x30ac0f));}catch(_0x2760aa){_0x1b5040(_0x2760aa);}}function _0x3cfd2c(_0xf05dd7){_0xf05dd7[a7_0x322c('0x1e')]?_0x17c9e8(_0xf05dd7[a7_0x322c('0x11')]):_0xf13239(_0xf05dd7[a7_0x322c('0x11')])[a7_0x322c('0x33')](_0x68e226,_0x66d7b4);}_0x3cfd2c((_0x4a56e2=_0x4a56e2['apply'](_0x249080,_0x352389||[]))['next']());});};Object[a7_0x322c('0x19')](exports,a7_0x322c('0x13'),{'value':!![]});exports[a7_0x322c('0x2')]=exports[a7_0x322c('0x35')]=void 0x0;const axios_1=require(a7_0x322c('0x8'));const environment_1=require(a7_0x322c('0x26'));const metric_logger_1=require(a7_0x322c('0x23'));const serializer_overrides_1=require(a7_0x322c('0x20'));const {output}=require(a7_0x322c('0x36'));class DistributedExecutionApi{constructor(_0x2a3f81){this[a7_0x322c('0x25')]=(0x0,axios_1[a7_0x322c('0xa')])(_0x2a3f81);}[a7_0x322c('0x2f')](_0x2315d1){var _0x4f2a01;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4c300d=(0x0,metric_logger_1[a7_0x322c('0x28')])(a7_0x322c('0xf'));let _0x3a9073;if(environment_1['VERBOSE_LOGGING']){output[a7_0x322c('0x1b')]({'title':a7_0x322c('0x29'),'bodyLines':[JSON[a7_0x322c('0x14')](_0x2315d1,null,0x2)]});}try{_0x3a9073=yield(0x0,axios_1[a7_0x322c('0x37')])(()=>this['apiAxiosInstance'][a7_0x322c('0x17')](a7_0x322c('0x2c'),_0x2315d1));_0x4c300d[a7_0x322c('0x2b')]((0x0,metric_logger_1[a7_0x322c('0x30')])(_0x3a9073));}catch(_0x5b6dae){_0x4c300d[a7_0x322c('0x2b')](((_0x4f2a01=_0x5b6dae===null||_0x5b6dae===void 0x0?void 0x0:_0x5b6dae['axiosException'])===null||_0x4f2a01===void 0x0?void 0x0:_0x4f2a01[a7_0x322c('0x9')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x5b6dae['axiosException'][a7_0x322c('0x9')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);throw _0x5b6dae;}if(!_0x3a9073['data']['enabled']){throw new Error(a7_0x322c('0x1f'));}if(_0x3a9073[a7_0x322c('0x24')]['error']){throw new Error(_0x3a9073['data'][a7_0x322c('0x3')]);}return _0x3a9073[a7_0x322c('0x24')]['id'];});}[a7_0x322c('0x6')](_0x466211){var _0x3d2533;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x12c2dd=(0x0,metric_logger_1['createMetricRecorder'])('dteStatus');try{const _0x2881f5=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a7_0x322c('0x25')][a7_0x322c('0x17')](a7_0x322c('0x22'),{'id':_0x466211}));_0x12c2dd['recordMetric']((0x0,metric_logger_1[a7_0x322c('0x30')])(_0x2881f5));return _0x2881f5[a7_0x322c('0x24')];}catch(_0xca6a01){_0x12c2dd[a7_0x322c('0x2b')](((_0x3d2533=_0xca6a01===null||_0xca6a01===void 0x0?void 0x0:_0xca6a01[a7_0x322c('0x4')])===null||_0x3d2533===void 0x0?void 0x0:_0x3d2533[a7_0x322c('0x9')])?(0x0,metric_logger_1[a7_0x322c('0x30')])(_0xca6a01[a7_0x322c('0x4')]['response']):metric_logger_1[a7_0x322c('0x21')]);output[a7_0x322c('0x3')]({'title':_0xca6a01[a7_0x322c('0x10')]});process[a7_0x322c('0x1a')](0x1);}});}[a7_0x322c('0x2a')](_0x4e9a96,_0x25e7fa){var _0x124c85;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x320ad9=(0x0,metric_logger_1[a7_0x322c('0x28')])(a7_0x322c('0x1'));if(environment_1[a7_0x322c('0x34')]){output['note']({'title':a7_0x322c('0x5'),'bodyLines':[a7_0x322c('0x0')+_0x4e9a96,'error:\x20'+_0x25e7fa]});}try{const _0x2f4e40=yield(0x0,axios_1['axiosMultipleTries'])(()=>this['apiAxiosInstance']['post'](a7_0x322c('0x32'),{'runGroup':_0x4e9a96,'criticalErrorMessage':_0x25e7fa}),0x3);_0x320ad9[a7_0x322c('0x2b')]((0x0,metric_logger_1[a7_0x322c('0x30')])(_0x2f4e40));}catch(_0x3cfd66){_0x320ad9[a7_0x322c('0x2b')](((_0x124c85=_0x3cfd66===null||_0x3cfd66===void 0x0?void 0x0:_0x3cfd66['axiosException'])===null||_0x124c85===void 0x0?void 0x0:_0x124c85[a7_0x322c('0x9')])?(0x0,metric_logger_1[a7_0x322c('0x30')])(_0x3cfd66['axiosException'][a7_0x322c('0x9')]):metric_logger_1[a7_0x322c('0x21')]);}});}}exports[a7_0x322c('0x35')]=DistributedExecutionApi;function createStartRequest(_0x449f4f,_0x46baa7,_0x2d41ba){const _0x3f43e0=_0x46baa7[a7_0x322c('0x1c')](_0x21251c=>{return _0x21251c['map'](_0x577b2f=>{return{'taskId':_0x577b2f['id'],'hash':_0x577b2f[a7_0x322c('0x12')],'projectName':_0x577b2f[a7_0x322c('0x38')][a7_0x322c('0x27')],'target':_0x577b2f['target'][a7_0x322c('0x38')],'configuration':_0x577b2f['target'][a7_0x322c('0x7')]||null,'params':(0x0,serializer_overrides_1[a7_0x322c('0xb')])(_0x577b2f)};});});const _0x4a422c={'command':(0x0,environment_1['parseCommand'])(),'branch':(0x0,environment_1[a7_0x322c('0xc')])(),'runGroup':_0x449f4f,'tasks':_0x3f43e0,'maxParallel':calculateMaxParallel(_0x2d41ba)};if(environment_1[a7_0x322c('0xd')]){_0x4a422c['agentCount']=environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT'];}if(!environment_1[a7_0x322c('0x2e')]){_0x4a422c[a7_0x322c('0x15')]=![];}return _0x4a422c;}exports['createStartRequest']=createStartRequest;function calculateMaxParallel(_0x11d238){if(_0x11d238[a7_0x322c('0xe')]===a7_0x322c('0x2d')||_0x11d238[a7_0x322c('0xe')]===![]){return 0x1;}else if(_0x11d238['parallel']===a7_0x322c('0x1d')||_0x11d238['parallel']===!![]){return Number(_0x11d238['maxParallel']||0x3);}else if(_0x11d238[a7_0x322c('0xe')]===undefined){return _0x11d238[a7_0x322c('0x18')]?Number(_0x11d238[a7_0x322c('0x18')]):0x3;}else{return Number(_0x11d238['parallel'])||0x3;}}